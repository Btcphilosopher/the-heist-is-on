<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Le Grand Mus√©e Heist - Paris Museum Heist Game</title>
    <style>
        * { margin:0; padding:0; box-sizing: border-box; }
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(to bottom, #1e3a8a, #1e40af, #991b1b);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .game-container {
            background: #1f2937;
            border-radius: 12px;
            box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5);
            padding: 24px;
            max-width: 850px;
        }
        .game-title {
            font-size: 32px;
            font-weight: bold;
            text-align: center;
            color: white;
            margin-bottom: 16px;
        }
        .stats-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            gap: 16px;
            flex-wrap: wrap;
        }
        .stat-item { display: flex; align-items: center; gap: 8px; font-size: 20px;font-weight:bold;}
        .stat-score { color: #fbbf24;}
        .stat-time { color: #60a5fa;}
        .stat-floor { color: #4ade80;}
        .stat-masterpieces { color: #c084fc;}
        .stat-police { color: #f87171;}
        .icon { width: 24px; height: 24px;}
        canvas { border:4px solid #4b5563; border-radius:8px; background:#fef3c7; display:block; max-width:100%;}
        .controls { margin-top:16px; text-align:center;}
        .btn {
            background: #2563eb;
            color: white;
            font-weight: bold;
            font-size: 20px;
            padding: 12px 32px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s;
        }
        .btn:hover { background: #1d4ed8;}
        .game-over { color: white; text-align:center; }
        .game-over h2 { font-size:36px; font-weight:bold; margin-bottom:12px;}
        .game-over p { font-size:20px; margin-bottom:8px;}
        .game-over .score-final { font-size:24px; font-weight:bold; margin-bottom:16px;}
        .game-over .bonus { font-size:20px; color: #fbbf24; margin-bottom:16px;}
        .caught { color: #ef4444;}
        .escaped { color: #22c55e;}
        .instructions { margin-top: 16px; text-align: center; color: #d1d5db; font-size:14px;}
        @media (max-width: 850px) {
            .stats-bar { font-size:16px;}
            .game-title { font-size:24px;}
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1 class="game-title">Le Grand Musee de Paris</h1>
        <div class="stats-bar">
            <div class="stat-item stat-score">
                <svg class="icon" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
                </svg>
                <span id="score">0</span>
            </div>
            <div class="stat-item stat-time">
                <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="M12 6v6l4 2"/>
                </svg>
                <span id="time">90.0s</span>
            </div>
            <div class="stat-item stat-floor">
                <span id="floor">Floor 1/3</span>
            </div>
            <div class="stat-item stat-masterpieces">
                <svg class="icon" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
                </svg>
                <span id="masterpieces">3/3</span>
            </div>
            <div class="stat-item stat-police">
                <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="M12 8v4m0 4h.01"/>
                </svg>
                <span id="police">100m</span>
            </div>
        </div>
        <canvas id="gameCanvas" width="800" height="600"></canvas>
        <div class="controls">
            <div id="menuScreen">
                <button class="btn" onclick="startGame()" id="startBtn">Commencer le Braquage</button>
            </div>
            <div id="caughtScreen" style="display:none;">
                <div class="game-over">
                    <h2 class="caught">Arrete!</h2>
                    <p>La Gendarmerie vous a attrape!</p>
                    <p class="score-final">Butin Final: <span id="finalScoreCaught">0</span></p>
                    <button class="btn" onclick="startGame()" id="retryBtn">Reessayer</button>
                </div>
            </div>
            <div id="escapedScreen" style="display:none;">
                <div class="game-over">
                    <h2 class="escaped">Echappe!</h2>
                    <p>Vous avez reussi le braquage!</p>
                    <p class="score-final">Butin Total: <span id="finalScoreEscaped">0</span></p>
                    <p class="bonus" id="bonusText"></p>
                    <button class="btn" onclick="startGame()" id="replayBtn">Rejouer</button>
                </div>
            </div>
        </div>
        <div class="instructions">
            WASD or Arrows to drive - 3 Floors with stairs - Walls wrap around - Police follow you!
        </div>
    </div>
    <script>
        // Game variables
        var canvas = document.getElementById('gameCanvas');
        var ctx = canvas.getContext('2d');
        var gameState = 'menu';
        var score = 0;
        var timeLeft = 90;
        var policeDistance = 100;
        var masterpiecesLeft = 3;
        var currentFloor = 1;
        var game = {
            car: { x: 400, y: 500, width: 40, height: 60, speed: 0, angle: 0, floor: 1 },
            items: [],
            police: [],
            staircases: [],
            keys: {},
            lastTime: 0
        };

        function resetScreens() {
            document.getElementById('menuScreen').style.display = 'none';
            document.getElementById('caughtScreen').style.display = 'none';
            document.getElementById('escapedScreen').style.display = 'none';
        }

        function showMenu() {
            resetScreens();
            document.getElementById('menuScreen').style.display = 'block';
        }

        function showCaught() {
            resetScreens();
            document.getElementById('caughtScreen').style.display = 'block';
        }

        function showEscaped() {
            resetScreens();
            document.getElementById('escapedScreen').style.display = 'block';
        }

        function startGame() {
            gameState = 'playing';
            score = 0;
            timeLeft = 90;
            policeDistance = 100;
            masterpiecesLeft = 3;
            currentFloor = 1;
            resetScreens();
            updateUI();
            initGame();
            game.lastTime = performance.now();
            requestAnimationFrame(gameLoop);
        }

        function initGame() {
            game.car = { x: 400, y: 500, width: 40, height: 60, speed: 0, angle: 0, floor: 1 };
            game.items = [];
            game.police = [];
            game.staircases = [];
            currentFloor = 1;
            // Floor stairs
            game.staircases.push(
                { x: 100, y: 100, width: 60, height: 80, from: 1, to: 2, type: 'up' },
                { x: 700, y: 400, width: 60, height: 80, from: 1, to: 2, type: 'up' },
                { x: 100, y: 400, width: 60, height: 80, from: 2, to: 1, type: 'down' },
                { x: 700, y: 100, width: 60, height: 80, from: 2, to: 1, type: 'down' },
                { x: 400, y: 50, width: 80, height: 60, from: 2, to: 3, type: 'up' },
                { x: 400, y: 500, width: 80, height: 60, from: 3, to: 2, type: 'down' }
            );
            // Floor 1 items
            game.items.push({
                x: 400, y: 200, value: 5000, collected: false, floor: 1,
                type: 'masterpiece', name: 'La Belle Mysterieuse', color: '#8b4513'
            });
            for (var i = 0; i < 4; i++) {
                game.items.push({
                    x: 150 + i * 150, y: 350 + (i % 2) * 100,
                    value: 800 + Math.floor(Math.random() * 400),
                    collected: false, floor: 1, type: 'painting'
                });
            }
            for (var i = 0; i < 3; i++) {
                game.items.push({
                    x: 200 + i * 200, y: 500,
                    value: 300 + Math.floor(Math.random() * 300),
                    collected: false, floor: 1, type: 'vase'
                });
            }
            // Floor 2 items
            game.items.push({
                x: 600, y: 300, value: 4500, collected: false, floor: 2,
                type: 'masterpiece', name: 'La Couronne Imperiale', color: '#ffd700'
            });
            for (var i = 0; i < 5; i++) {
                game.items.push({
                    x: 100 + i * 140, y: 200 + (i % 2) * 150,
                    value: 600 + Math.floor(Math.random() * 500),
                    collected: false, floor: 2,
                    type: i % 2 === 0 ? 'crown' : 'jewel'
                });
            }
            // Floor 3 items
            game.items.push({
                x: 400, y: 300, value: 4000, collected: false, floor: 3,
                type: 'masterpiece', name: 'Le Portrait Royal', color: '#c19a6b'
            });
            for (var i = 0; i < 4; i++) {
                game.items.push({
                    x: 150 + i * 170, y: 150,
                    value: 600 + Math.floor(Math.random() * 400),
                    collected: false, floor: 3, type: 'statue'
                });
            }
            for (var i = 0; i < 3; i++) {
                game.items.push({
                    x: 250 + i * 150, y: 450,
                    value: 400 + Math.floor(Math.random() * 300),
                    collected: false, floor: 3, type: 'painting'
                });
            }
            for (var i = 0; i < 3; i++) {
                game.police.push({
                    x: Math.random() * 800,
                    y: 50 + i * 150,
                    speed: 1.5 + Math.random() * 0.3,
                    floor: 1
                });
            }
        }

        function updateUI() {
            document.getElementById('score').textContent = score.toLocaleString();
            document.getElementById('time').textContent = timeLeft.toFixed(1) + 's';
            document.getElementById('floor').textContent = 'Floor ' + currentFloor + '/3';
            document.getElementById('masterpieces').textContent = masterpiecesLeft + '/3';
            document.getElementById('police').textContent = policeDistance + 'm';
        }

        function update(dt) {
            var car = game.car;
            var keys = game.keys;
            var items = game.items;
            var police = game.police;
            var staircases = game.staircases;

            // Controls - slower acceleration
            if (keys['ArrowUp'] || keys['w'] || keys['W']) {
                car.speed = Math.min(car.speed + 0.25, 6);
            } else if (keys['ArrowDown'] || keys['s'] || keys['S']) {
                car.speed = Math.max(car.speed - 0.25, -3);
            } else {
                car.speed *= 0.92;
            }
            if (keys['ArrowLeft'] || keys['a'] || keys['A']) car.angle -= 0.06 * Math.abs(car.speed);
            if (keys['ArrowRight'] || keys['d'] || keys['D']) car.angle += 0.06 * Math.abs(car.speed);

            car.x += Math.sin(car.angle) * car.speed;
            car.y -= Math.cos(car.angle) * car.speed;
            if (car.x < 0) car.x = 800; if (car.x > 800) car.x = 0;
            if (car.y < 0) car.y = 600; if (car.y > 600) car.y = 0;

            // Stairs
            for (var i = 0; i < staircases.length; i++) {
                var stair = staircases[i];
                if (stair.from === car.floor) {
                    if (car.x > stair.x && car.x < stair.x + stair.width &&
                        car.y > stair.y && car.y < stair.y + stair.height) {
                        car.floor = stair.to;
                        currentFloor = stair.to;
                        if (stair.type === 'up') car.y = stair.y + stair.height + 50;
                        else car.y = stair.y - 50;
                    }
                }
            }

            // Items - larger collision radius
            for (var i = 0; i < items.length; i++) {
                var item = items[i];
                if (!item.collected && item.floor === car.floor) {
                    var dx = car.x - item.x, dy = car.y - item.y;
                    var distance = Math.sqrt(dx * dx + dy * dy);
                    var collisionDist = item.type === 'masterpiece' ? 60 : 50;
                    if (distance < collisionDist) {
                        item.collected = true;
                        score += item.value;
                        if (item.type === 'masterpiece') masterpiecesLeft--;
                    }
                }
            }

            // Police - much slower
            var minDistance = 1000;
            for (var i = 0; i < police.length; i++) {
                var cop = police[i];
                if (cop.floor === car.floor) {
                    var dx = car.x - cop.x, dy = car.y - cop.y, dist = Math.sqrt(dx*dx+dy*dy);
                    minDistance = Math.min(minDistance, dist);
                    cop.x += dx * 0.012;
                    cop.y += dy * 0.012;
                    if (dist < 40) endGame('caught');
                } else {
                    var stairsToCar = staircases.filter(s=>s.from===cop.floor&&s.to===car.floor);
                    if (stairsToCar.length) {
                        var stair = stairsToCar[0];
                        var dx = stair.x + stair.width/2 - cop.x, dy = stair.y + stair.height/2 - cop.y;
                        var dist = Math.sqrt(dx*dx+dy*dy);
                        if (dist > 0) { cop.x += (dx/dist)*1.2; cop.y += (dy/dist)*1.2; }
                        if (dist < 40) cop.floor = stair.to;
                    }
                }
                if (cop.x < 0) cop.x = 800; if (cop.x > 800) cop.x = 0;
                if (cop.y < 0) cop.y = 600; if (cop.y > 600) cop.y = 0;
            }
            policeDistance = minDistance === 1000 ? 99 : Math.floor(minDistance);
            timeLeft = Math.max(0, timeLeft - 0.016);
            if (timeLeft <= 0) endGame('escaped');
            updateUI();
        }

        function endGame(result) {
            gameState = result;
            updateUI();
            if (result === 'caught') {
                document.getElementById('finalScoreCaught').textContent = score.toLocaleString();
                showCaught();
            } else if (result === 'escaped') {
                document.getElementById('finalScoreEscaped').textContent = score.toLocaleString();
                document.getElementById('bonusText').textContent = masterpiecesLeft === 0 ? 'All masterpieces stolen!' : '';
                showEscaped();
            }
        }

        function draw() {
            var car = game.car, items = game.items, police = game.police, staircases = game.staircases;
            var floorColors = { 1: '#f5f0e8', 2: '#e8e5f0', 3: '#f0e8e5' };
            ctx.fillStyle = floorColors[car.floor] || '#f5f0e8';
            ctx.fillRect(0, 0, 800, 600);
            ctx.strokeStyle = '#d4c8b8'; ctx.lineWidth = 2;
            for (var x = 0; x < 800; x += 80) for (var y = 0; y < 600; y += 80) ctx.strokeRect(x, y, 80, 80);
            // Stairs
            for (var i = 0; i < staircases.length; i++) {
                var stair = staircases[i];
                if (stair.from === car.floor) {
                    ctx.fillStyle = stair.type === 'up' ? '#4a9eff' : '#ff9a4a';
                    ctx.fillRect(stair.x, stair.y, stair.width, stair.height);
                    ctx.fillStyle = '#fff'; ctx.font = 'bold 16px Arial'; ctx.textAlign = 'center';
                    var text = stair.type === 'up' ? 'UP' : 'DOWN';
                    ctx.fillText(text, stair.x + stair.width/2, stair.y + stair.height/2 + 6);
                }
            }
            // Items
            for (var i = 0; i < items.length; i++) {
                var item = items[i];
                if (!item.collected && item.floor === car.floor) {
                    ctx.save(); ctx.translate(item.x, item.y);
                    if (item.type === 'masterpiece') {
                        ctx.fillStyle = '#654321'; ctx.fillRect(-30,-35,60,65);
                        ctx.fillStyle = item.color; ctx.fillRect(-25,-30,50,55);
                        ctx.fillStyle = '#ffd700';
                        ctx.fillRect(-32,-37,8,8); ctx.fillRect(24,-37,8,8);
                        ctx.fillRect(-32,29,8,8); ctx.fillRect(24,29,8,8);
                    } else if (item.type === 'painting') {
                        ctx.fillStyle = '#5c4033'; ctx.fillRect(-18,-24,36,42);
                        ctx.fillStyle = '#8b6f47'; ctx.fillRect(-15,-21,30,36);
                    } else if (item.type === 'statue') {
                        ctx.fillStyle = '#e8e8e8'; ctx.fillRect(-10,-20,20,40);
                        ctx.fillRect(-8,-28,16,12);
                    } else if (item.type === 'vase') {
                        ctx.fillStyle = '#cd853f'; ctx.beginPath();
                        ctx.arc(0,0,14,0,Math.PI*2); ctx.fill();
                    } else if (item.type === 'crown') {
                        ctx.fillStyle = '#ffd700';
                        ctx.fillRect(-12,-6,24,12);
                        for (var j=-10;j<=10;j+=10) ctx.fillRect(j-2,-12,4,8);
                    } else if (item.type === 'jewel') {
                        ctx.fillStyle = '#4169e1'; ctx.beginPath();
                        ctx.arc(0,0,10,0,Math.PI*2); ctx.fill();
                    }
                    ctx.restore();
                }
            }
            // Police
            for (var i = 0; i < police.length; i++) {
                var cop = police[i];
                if (cop.floor === car.floor) {
                    ctx.save(); ctx.translate(cop.x, cop.y);
                    ctx.fillStyle = '#1e3a8a'; ctx.fillRect(-20,-32,40,64);
                    ctx.fillStyle = '#4a5568'; ctx.fillRect(-15,-22,30,24);
                    ctx.fillStyle = '#ef4135'; ctx.fillRect(-18,-30,12,6); ctx.fillRect(6,-30,12,6);
                    ctx.fillStyle = '#ffffff'; ctx.font = 'bold 9px Arial'; ctx.textAlign = 'center';
                    ctx.fillText('POLICE', 0, 8);
                    ctx.restore();
                }
            }
            // Car
            ctx.save(); ctx.translate(car.x, car.y); ctx.rotate(car.angle);
            ctx.fillStyle = '#1a1a1a'; ctx.fillRect(-20,-30,40,60);
            ctx.fillStyle = '#2d2d2d'; ctx.fillRect(-15,-20,30,28);
            ctx.fillStyle = '#000';
            ctx.fillRect(-24,-22,10,16); ctx.fillRect(14,-22,10,16);
            ctx.fillRect(-24,6,10,16); ctx.fillRect(14,6,10,16);
            ctx.fillStyle = '#ffff99'; ctx.fillRect(-15,-32,8,4); ctx.fillRect(7,-32,8,4);
            ctx.restore();
        }

        function drawMenu() {
            ctx.fillStyle = '#f5f0e8';
            ctx.fillRect(0, 0, 800, 600);
            ctx.fillStyle = '#1a1a1a'; ctx.font = 'bold 54px Georgia'; ctx.textAlign = 'center';
            ctx.fillText('Le Grand Musee Heist', 400, 200);
            ctx.font = 'italic 28px Georgia'; ctx.fillStyle = '#0055a4';
            ctx.fillText('Paris, France', 400, 250);
            ctx.font = '22px Arial'; ctx.fillStyle = '#333';
            ctx.fillText('3 Floors - Wraparound Walls', 400, 320);
            ctx.fillText('Use stairs to evade police!', 400, 355);
            ctx.font = '18px Arial'; ctx.fillStyle = '#666';
            ctx.fillText('Arrow Keys or WASD to drive', 400, 420);
            ctx.fillText('Drive through walls to wrap around', 400, 450);
        }

        function gameLoop(timestamp) {
            var deltaTime = timestamp - game.lastTime;
            if (gameState === 'playing' && deltaTime > 10) {
                game.lastTime = timestamp;
                update(deltaTime / 16);
            }
            if (gameState === 'menu') drawMenu();
            else draw();
            if (gameState !== 'caught' && gameState !== 'escaped') requestAnimationFrame(gameLoop);
        }

        window.addEventListener('keydown', function(e) {
            if (e.key === "Enter") {
                if (document.getElementById('menuScreen').style.display !== "none") startGame();
                if (document.getElementById('caughtScreen').style.display !== "none") startGame();
                if (document.getElementById('escapedScreen').style.display !== "none") startGame();
            } else {
                game.keys[e.key] = true;
            }
        });
        window.addEventListener('keyup', function(e) { game.keys[e.key] = false; });

        showMenu();
        drawMenu();

    </script>
</body>
</html>
